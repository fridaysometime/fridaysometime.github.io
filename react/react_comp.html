<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如何开发高度复用的 React UI 组件 | 我的小天地</title>
    <meta name="description" content="here is mysite">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.f00e75f3.css" as="style"><link rel="preload" href="/assets/js/app.21fc7165.js" as="script"><link rel="preload" href="/assets/js/91.5df52d19.js" as="script"><link rel="prefetch" href="/assets/js/10.77ddf168.js"><link rel="prefetch" href="/assets/js/100.72376ebc.js"><link rel="prefetch" href="/assets/js/101.7e92dcce.js"><link rel="prefetch" href="/assets/js/102.d26ace53.js"><link rel="prefetch" href="/assets/js/103.4f071c6b.js"><link rel="prefetch" href="/assets/js/104.68913947.js"><link rel="prefetch" href="/assets/js/105.7c5f4e31.js"><link rel="prefetch" href="/assets/js/106.d3f3424c.js"><link rel="prefetch" href="/assets/js/107.384cbc4b.js"><link rel="prefetch" href="/assets/js/108.58c1a8ed.js"><link rel="prefetch" href="/assets/js/109.592ca513.js"><link rel="prefetch" href="/assets/js/11.fb633ed3.js"><link rel="prefetch" href="/assets/js/110.2387ccdb.js"><link rel="prefetch" href="/assets/js/111.3adc7fd4.js"><link rel="prefetch" href="/assets/js/112.043aeb0d.js"><link rel="prefetch" href="/assets/js/113.28e7ece7.js"><link rel="prefetch" href="/assets/js/114.c2a39640.js"><link rel="prefetch" href="/assets/js/115.d69cc20a.js"><link rel="prefetch" href="/assets/js/116.23269a8b.js"><link rel="prefetch" href="/assets/js/117.bb096cb5.js"><link rel="prefetch" href="/assets/js/118.d630c8af.js"><link rel="prefetch" href="/assets/js/119.6b68bb67.js"><link rel="prefetch" href="/assets/js/12.d634c6b6.js"><link rel="prefetch" href="/assets/js/120.2c3c6894.js"><link rel="prefetch" href="/assets/js/121.cb26b817.js"><link rel="prefetch" href="/assets/js/122.8e57909d.js"><link rel="prefetch" href="/assets/js/123.7c4ed3b7.js"><link rel="prefetch" href="/assets/js/124.4d229fc4.js"><link rel="prefetch" href="/assets/js/125.8308ed0a.js"><link rel="prefetch" href="/assets/js/126.57c6442c.js"><link rel="prefetch" href="/assets/js/127.9338f913.js"><link rel="prefetch" href="/assets/js/128.7a0b895a.js"><link rel="prefetch" href="/assets/js/129.a1d4aea2.js"><link rel="prefetch" href="/assets/js/13.e330f7db.js"><link rel="prefetch" href="/assets/js/130.15664e23.js"><link rel="prefetch" href="/assets/js/131.a725dcd2.js"><link rel="prefetch" href="/assets/js/132.838cb70d.js"><link rel="prefetch" href="/assets/js/133.cbdf7276.js"><link rel="prefetch" href="/assets/js/14.c68bef90.js"><link rel="prefetch" href="/assets/js/15.3157a246.js"><link rel="prefetch" href="/assets/js/16.2962be19.js"><link rel="prefetch" href="/assets/js/17.f4f7b3f6.js"><link rel="prefetch" href="/assets/js/18.263a4859.js"><link rel="prefetch" href="/assets/js/19.99fb5921.js"><link rel="prefetch" href="/assets/js/20.24e69b19.js"><link rel="prefetch" href="/assets/js/21.d27fc0ca.js"><link rel="prefetch" href="/assets/js/22.898767e5.js"><link rel="prefetch" href="/assets/js/23.ebd340a0.js"><link rel="prefetch" href="/assets/js/24.b41d02fb.js"><link rel="prefetch" href="/assets/js/25.f85ce66b.js"><link rel="prefetch" href="/assets/js/26.e3a66d4f.js"><link rel="prefetch" href="/assets/js/27.1db2160c.js"><link rel="prefetch" href="/assets/js/28.9dee9ccb.js"><link rel="prefetch" href="/assets/js/29.a4bc7d56.js"><link rel="prefetch" href="/assets/js/3.87f8e697.js"><link rel="prefetch" href="/assets/js/30.a5d1adac.js"><link rel="prefetch" href="/assets/js/31.ce3a2866.js"><link rel="prefetch" href="/assets/js/32.c022f01a.js"><link rel="prefetch" href="/assets/js/33.7b2bd810.js"><link rel="prefetch" href="/assets/js/34.e368eaf9.js"><link rel="prefetch" href="/assets/js/35.a53794dd.js"><link rel="prefetch" href="/assets/js/36.90e47b7b.js"><link rel="prefetch" href="/assets/js/37.23a9a793.js"><link rel="prefetch" href="/assets/js/38.4280a64c.js"><link rel="prefetch" href="/assets/js/39.b5569187.js"><link rel="prefetch" href="/assets/js/4.fc2e3498.js"><link rel="prefetch" href="/assets/js/40.a222dcd7.js"><link rel="prefetch" href="/assets/js/41.d7d087d2.js"><link rel="prefetch" href="/assets/js/42.0283d3c0.js"><link rel="prefetch" href="/assets/js/43.32388d5e.js"><link rel="prefetch" href="/assets/js/44.e4e23599.js"><link rel="prefetch" href="/assets/js/45.4aba455a.js"><link rel="prefetch" href="/assets/js/46.60750c8e.js"><link rel="prefetch" href="/assets/js/47.d0d66696.js"><link rel="prefetch" href="/assets/js/48.c00c91da.js"><link rel="prefetch" href="/assets/js/49.c7ee7317.js"><link rel="prefetch" href="/assets/js/5.073f04da.js"><link rel="prefetch" href="/assets/js/50.49c34cfe.js"><link rel="prefetch" href="/assets/js/51.4969bb0f.js"><link rel="prefetch" href="/assets/js/52.9af50168.js"><link rel="prefetch" href="/assets/js/53.9eaf0570.js"><link rel="prefetch" href="/assets/js/54.9b525d72.js"><link rel="prefetch" href="/assets/js/55.037a6cf9.js"><link rel="prefetch" href="/assets/js/56.1a82c27d.js"><link rel="prefetch" href="/assets/js/57.a26897c7.js"><link rel="prefetch" href="/assets/js/58.86e43bad.js"><link rel="prefetch" href="/assets/js/59.3d0dcce9.js"><link rel="prefetch" href="/assets/js/6.cb238ab6.js"><link rel="prefetch" href="/assets/js/60.94e22b00.js"><link rel="prefetch" href="/assets/js/61.10aab864.js"><link rel="prefetch" href="/assets/js/62.850e11a7.js"><link rel="prefetch" href="/assets/js/63.c45c2f9d.js"><link rel="prefetch" href="/assets/js/64.47a82193.js"><link rel="prefetch" href="/assets/js/65.4b9b194e.js"><link rel="prefetch" href="/assets/js/66.33263553.js"><link rel="prefetch" href="/assets/js/67.4207ce17.js"><link rel="prefetch" href="/assets/js/68.b559d50a.js"><link rel="prefetch" href="/assets/js/69.4305dd76.js"><link rel="prefetch" href="/assets/js/7.734625c8.js"><link rel="prefetch" href="/assets/js/70.20f2775d.js"><link rel="prefetch" href="/assets/js/71.6fffb114.js"><link rel="prefetch" href="/assets/js/72.236d90cd.js"><link rel="prefetch" href="/assets/js/73.5b801045.js"><link rel="prefetch" href="/assets/js/74.5698c503.js"><link rel="prefetch" href="/assets/js/75.b7c0b5dc.js"><link rel="prefetch" href="/assets/js/76.55208887.js"><link rel="prefetch" href="/assets/js/77.6050e344.js"><link rel="prefetch" href="/assets/js/78.f2df4ed8.js"><link rel="prefetch" href="/assets/js/79.38139ab0.js"><link rel="prefetch" href="/assets/js/8.204c29ff.js"><link rel="prefetch" href="/assets/js/80.faf07d95.js"><link rel="prefetch" href="/assets/js/81.89134c80.js"><link rel="prefetch" href="/assets/js/82.a1b28472.js"><link rel="prefetch" href="/assets/js/83.5c3f0588.js"><link rel="prefetch" href="/assets/js/84.02d8001e.js"><link rel="prefetch" href="/assets/js/85.dbfb4564.js"><link rel="prefetch" href="/assets/js/86.8f8a28e5.js"><link rel="prefetch" href="/assets/js/87.47410eb6.js"><link rel="prefetch" href="/assets/js/88.57b92e6e.js"><link rel="prefetch" href="/assets/js/89.eb0bc727.js"><link rel="prefetch" href="/assets/js/9.4ed47bd6.js"><link rel="prefetch" href="/assets/js/90.853e4852.js"><link rel="prefetch" href="/assets/js/92.70253793.js"><link rel="prefetch" href="/assets/js/93.2f432fed.js"><link rel="prefetch" href="/assets/js/94.0c32d97b.js"><link rel="prefetch" href="/assets/js/95.dc1bc72e.js"><link rel="prefetch" href="/assets/js/96.8711aa7d.js"><link rel="prefetch" href="/assets/js/97.8aa87e11.js"><link rel="prefetch" href="/assets/js/98.cd50d53c.js"><link rel="prefetch" href="/assets/js/99.b4c61b3a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.241ee574.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f00e75f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header id="navbarWrapper" class="navbar"><div class="sidebar-button"><i class="iconfont reco-menu"></i></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">我的小天地</span></a> <div class="links" style="max-width:nullpx;"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      blogs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  React学习汇总
</a></li><li class="dropdown-item"><!----> <a href="/vuePress/" class="nav-link"><i class="iconfont undefined"></i>
  使用 GitHub Pages 和 VuePress 搭建网站
</a></li><li class="dropdown-item"><!----> <a href="/studyDiary/" class="nav-link"><i class="iconfont undefined"></i>
  学习总结
</a></li><li class="dropdown-item"><!----> <a href="/pythonLeetcode/" class="nav-link"><i class="iconfont undefined"></i>
  Python_leetcode
</a></li><li class="dropdown-item"><!----> <a href="/newyear2020/" class="nav-link"><i class="iconfont undefined"></i>
  NewYear_2020
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont undefined"></i>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      GitHub
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fridaysometime" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub地址
  </a></li></ul></div></div><div class="nav-item"><a href="/tags/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      blogs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  React学习汇总
</a></li><li class="dropdown-item"><!----> <a href="/vuePress/" class="nav-link"><i class="iconfont undefined"></i>
  使用 GitHub Pages 和 VuePress 搭建网站
</a></li><li class="dropdown-item"><!----> <a href="/studyDiary/" class="nav-link"><i class="iconfont undefined"></i>
  学习总结
</a></li><li class="dropdown-item"><!----> <a href="/pythonLeetcode/" class="nav-link"><i class="iconfont undefined"></i>
  Python_leetcode
</a></li><li class="dropdown-item"><!----> <a href="/newyear2020/" class="nav-link"><i class="iconfont undefined"></i>
  NewYear_2020
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont undefined"></i>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      GitHub
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fridaysometime" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub地址
  </a></li></ul></div></div><div class="nav-item"><a href="/tags/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/react/classnames.html" class="sidebar-link">classnames</a></li><li><a href="/react/propTypes.html" class="sidebar-link">使用 PropTypes 进行类型检测</a></li><li><a href="/react/react16-hooks.html" class="sidebar-link">React Hooks</a></li><li><a href="/react/react生命周期.html" class="sidebar-link">React 生命周期</a></li><li><a href="/react/react_comp.html" class="active sidebar-link">如何开发高度复用的 React UI 组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react_comp.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/react/react_comp.html#准备-前端环境" class="sidebar-link">准备: 前端环境</a></li><li class="sidebar-sub-header"><a href="/react/react_comp.html#第一部分-了解组件需要的参数及方法" class="sidebar-link">第一部分: 了解组件需要的参数及方法</a></li><li class="sidebar-sub-header"><a href="/react/react_comp.html#第二部分-根据-props-开发具体组件代码" class="sidebar-link">第二部分: 根据 props 开发具体组件代码</a></li><li class="sidebar-sub-header"><a href="/react/react_comp.html#第三部分-利用-classnames，给组件美化" class="sidebar-link">第三部分: 利用 classnames，给组件美化</a></li><li class="sidebar-sub-header"><a href="/react/react_comp.html#第四部分-添砖加瓦" class="sidebar-link">第四部分: 添砖加瓦</a></li><li class="sidebar-sub-header"><a href="/react/react_comp.html#第五部分-单元测试" class="sidebar-link">第五部分: 单元测试</a></li></ul></li></ul></div></li></ul> </div> <div class="page" data-v-4bd020d4> <div class="page-title" data-v-4bd020d4><h1 data-v-4bd020d4>如何开发高度复用的 React UI 组件</h1> <hr data-v-4bd020d4> <div data-v-2c25cede data-v-4bd020d4><i class="iconfont reco-account" data-v-2c25cede><span data-v-2c25cede>我的小天地</span></i> <!----> <!----> <!----></div></div> <div class="content" data-v-4bd020d4><h1 id="如何开发高度复用的-react-ui-组件"><a href="#如何开发高度复用的-react-ui-组件" aria-hidden="true" class="header-anchor">#</a> 如何开发高度复用的 React UI 组件</h1> <h2 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h2> <p>本次分享中，我将通过示例代码，讲解如何高效开发可用的 React UI 组件。</p> <h3 id="提问-现在开源-ui-组件已经很成熟了，为什么还要自己开发-ui-组件呢？"><a href="#提问-现在开源-ui-组件已经很成熟了，为什么还要自己开发-ui-组件呢？" aria-hidden="true" class="header-anchor">#</a> 提问: 现在开源 UI 组件已经很成熟了，为什么还要自己开发 UI 组件呢？</h3> <p>总结了大概 3 点：</p> <ol><li>学习。开发过程中也是一种学习的过程，通过自己开发组件，可以更好地理解开源组件的内部原理，从而更好地指导我们使用。</li> <li>改造。项目中，难免会用到一些开源库中没有的 API 或功能。由此可以更快更效率的对开源库进行改造。</li> <li>定制化。开发整套组件，可以更好地应对公司、部门的定制化项目。保证 UI 的统一。例如：JDReact-Native</li></ol> <h2 id="准备-前端环境"><a href="#准备-前端环境" aria-hidden="true" class="header-anchor">#</a> 准备: 前端环境</h2> <ol><li>首先我们需要 ES6 环境，所以需要对应的 babel</li> <li>编写组件，代码的规范和提交的规范是必不可少的。参考<a href="https://github.com/rmbf2e/frondend-git" target="_blank" rel="noopener noreferrer">代码规范和提交规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>需要测试我们的组件。对应的 Jest 配置</li> <li>需要展示组件。可以用成熟的展示库 storebook 等等</li> <li>发布组件。</li></ol> <h2 id="第一部分-了解组件需要的参数及方法"><a href="#第一部分-了解组件需要的参数及方法" aria-hidden="true" class="header-anchor">#</a> 第一部分: 了解组件需要的参数及方法</h2> <p>成熟的开源库中，一般在组件展示页面底部我们都能看到一个 API 表格:</p> <table><thead><tr><th style="text-align:center">属性</th> <th style="text-align:center">说明</th> <th style="text-align:center">类型</th> <th style="text-align:center">默认值</th></tr></thead> <tbody><tr><td style="text-align:center">disabled</td> <td style="text-align:center">失效状态</td> <td style="text-align:center">boolean</td> <td style="text-align:center">false</td></tr> <tr><td style="text-align:center">loading</td> <td style="text-align:center">设置载入状态</td> <td style="text-align:center">boolean</td> <td style="text-align:center">false</td></tr></tbody></table> <p>在我们开发一个组件的初期，可以从成熟组件入手，看看一个高度可复用的组件需要传入什么参数：可参考 <a href="https://ant.design/" target="_blank" rel="noopener noreferrer">antd<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 及 <a href="http://element.eleme.io/#/" target="_blank" rel="noopener noreferrer">element-UI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>有了参考，我们要进一步对入参进行筛选过滤。</p> <p>举个例子：一个 Button 组件，我提炼出来的属性有</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>loading,
disabled,
block,
type,
className,
htmlType,
onClick,
size,
href,
dashed,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>对应属性，我们可以生成如下表格：</p> <table><thead><tr><th style="text-align:left">属性</th> <th style="text-align:left">说明</th> <th style="text-align:center">类型</th> <th style="text-align:center">默认值</th></tr></thead> <tbody><tr><td style="text-align:left">disabled</td> <td style="text-align:left">按钮失效状态</td> <td style="text-align:center">boolean</td> <td style="text-align:center">false</td></tr> <tr><td style="text-align:left">href</td> <td style="text-align:left">点击跳转的地址，指定此属性 button 的行为和 a 链接一致</td> <td style="text-align:center">string</td> <td style="text-align:center">-</td></tr> <tr><td style="text-align:left">htmlType</td> <td style="text-align:left">设置 button 原生的 type 值</td> <td style="text-align:center">string</td> <td style="text-align:center">button</td></tr> <tr><td style="text-align:left">loading</td> <td style="text-align:left">设置按钮载入状态</td> <td style="text-align:center">boolean</td> <td style="text-align:center">false</td></tr> <tr><td style="text-align:left">size</td> <td style="text-align:left">设置按钮大小，可选值为 small large 或者不设</td> <td style="text-align:center">string</td> <td style="text-align:center">default</td></tr> <tr><td style="text-align:left">type</td> <td style="text-align:left">设置按钮类型，可选值为 primary dashed danger(版本 2.7 中增加) 或者不设</td> <td style="text-align:center">string</td> <td style="text-align:center">-</td></tr> <tr><td style="text-align:left">onClick</td> <td style="text-align:left">点击按钮时的回调</td> <td style="text-align:center">(event) =&gt; void</td> <td style="text-align:center">-</td></tr> <tr><td style="text-align:left">block</td> <td style="text-align:left">将按钮宽度调整为其父宽度的选项</td> <td style="text-align:center">boolean</td> <td style="text-align:center">false</td></tr></tbody></table> <p>参数确定之后，在编写组件之前，我们需要对组件的参数进行校验。React 恰恰给我们提供了一个这样的校验工具集：</p> <ul><li>工具<a href="https://www.npmjs.com/package/prop-types" target="_blank" rel="noopener noreferrer">prop-types<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
安装</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yarn add prop-types
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>简易使用方法：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>static propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  // 你可以定义一个js原始类型的prop,默认请情况下，这是都是可选的
  optionalArray: React.PropTypes.array,
  optionalBool: React.PropTypes.bool,
  optionalFunc: React.PropTypes.func,
  optionalNumber: React.PropTypes.number,
  optionalObject: React.PropTypes.object,
  optionalString: React.PropTypes.string,
  optionalSymbol: React.PropTypes.symbol,

  // 任何可以渲染的东西：数字，字符串，元素或数组（或片段）。
  optionalNode: React.PropTypes.node,

  // React元素
  optionalElement: React.PropTypes.element,

  // 你也可以声明prop是某个类的实例。 内部使用的是JS的instanceof运算符。
  optionalMessage: React.PropTypes.instanceOf<span class="token punctuation">(</span>Message<span class="token punctuation">)</span>,

  // 你可以通过将它作为枚举来确保你的prop被限制到特定的值。
  optionalEnum: React.PropTypes.oneOf<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'News'</span>, <span class="token string">'Photos'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>,

  // 可以是许多类型之一的对象
  optionalUnion: React.PropTypes.oneOfType<span class="token punctuation">(</span><span class="token punctuation">[</span>
    React.PropTypes.string,
    React.PropTypes.number,
    React.PropTypes.instanceOf<span class="token punctuation">(</span>Message<span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span>,

  // 某种类型的数组
  optionalArrayOf: React.PropTypes.arrayOf<span class="token punctuation">(</span>React.PropTypes.number<span class="token punctuation">)</span>,

  // 具有某种类型的属性值的对象
  optionalObjectOf: React.PropTypes.objectOf<span class="token punctuation">(</span>React.PropTypes.number<span class="token punctuation">)</span>,

  // 采取特定样式的对象
  optionalObjectWithShape: React.PropTypes.shape<span class="token punctuation">(</span><span class="token punctuation">{</span>
    color: React.PropTypes.string,
    fontSize: React.PropTypes.number
  <span class="token punctuation">}</span><span class="token punctuation">)</span>,

  // 你可以用<span class="token variable"><span class="token variable">`</span>isRequired<span class="token variable">`</span></span>来连接到上面的任何一个类型，以确保如果没有提供props的话会显示一个警告。
  requiredFunc: React.PropTypes.func.isRequired,

  // 任何数据类型
  requiredAny: React.PropTypes.any.isRequired,

  // 您还可以指定自定义类型检查器。 如果检查失败，它应该返回一个Error对象。 不要<span class="token variable"><span class="token variable">`</span>console.warn<span class="token variable">`</span></span>或throw，因为这不会在<span class="token variable"><span class="token variable">`</span>oneOfType<span class="token variable">`</span></span>内工作。
  customProp: function<span class="token punctuation">(</span>props, propName, componentName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>/matchme/.test<span class="token punctuation">(</span>props<span class="token punctuation">[</span>propName<span class="token punctuation">]</span><span class="token punctuation">))</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new Error<span class="token punctuation">(</span>
        <span class="token string">'Invalid prop <span class="token variable"><span class="token variable">`</span><span class="token string">' + propName + '</span><span class="token variable">`</span></span> supplied to'</span> +
        <span class="token string">' <span class="token variable"><span class="token variable">`</span><span class="token string">' + componentName + '</span><span class="token variable">`</span></span>. Validation failed.'</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>,

  // 您还可以为<span class="token variable"><span class="token variable">`</span>arrayOf<span class="token variable">`</span></span>和<span class="token variable"><span class="token variable">`</span>objectOf<span class="token variable">`</span></span>提供自定义类型检查器。 如果检查失败，它应该返回一个Error对象。
  // 检查器将为数组或对象中的每个键调用验证函数。
  // 检查器有两个参数，第一个参数是数组或对象本身，第二个是当前项的键。
  customArrayProp: React.PropTypes.arrayOf<span class="token punctuation">(</span>function<span class="token punctuation">(</span>propValue, key, componentName, location, propFullName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>/matchme/.test<span class="token punctuation">(</span>propValue<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">))</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new Error<span class="token punctuation">(</span>
        <span class="token string">'Invalid prop <span class="token variable"><span class="token variable">`</span><span class="token string">' + propFullName + '</span><span class="token variable">`</span></span> supplied to'</span> +
        <span class="token string">' <span class="token variable"><span class="token variable">`</span><span class="token string">' + componentName + '</span><span class="token variable">`</span></span>. Validation failed.'</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><p>💡: 由于我们使用的是 eslint airbnb 的校验规则集，组件内使用的任何 props 都需要定义 propTypes 以及 defaultProps。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>static propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  prefixCls: PropTypes.string,
  href: PropTypes.string,
  type: PropTypes.oneOf<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">'primary'</span>,
    <span class="token string">'default'</span>,
    <span class="token string">'warning'</span>,
    <span class="token string">'success'</span>,
    <span class="token string">'error'</span>,
    <span class="token string">'info'</span>,
    <span class="token string">'danger'</span>,
    <span class="token string">'disabled'</span>,
  <span class="token punctuation">]</span><span class="token punctuation">)</span>,
  htmlType: PropTypes.string,
  loading: PropTypes.bool,
  block: PropTypes.bool,
  disabled: PropTypes.bool,
  size: PropTypes.oneOf<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'small'</span>, <span class="token string">'default'</span>, <span class="token string">'large'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>,
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>💡 对应校验入参应该都有默认值。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>static defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  prefixCls: <span class="token string">'xx-button'</span>,
  href: <span class="token string">''</span>,
  type: <span class="token string">'default'</span>,
  htmlType: <span class="token string">'button'</span>,
  loading: false,
  block: false,
  disabled: false,
  size: <span class="token string">'default'</span>,
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="第二部分-根据-props-开发具体组件代码"><a href="#第二部分-根据-props-开发具体组件代码" aria-hidden="true" class="header-anchor">#</a> 第二部分: 根据 props 开发具体组件代码</h2> <p>开发的常用 UI 组件，HTML 里面基本都有涉及。例如 Radio，CheckBox，Input，Button，Color 选择器，日期选择器等等。</p> <p>我们需要做的，就是在 HTML 基本选择器上，把 Step1 的 props 添加进去，让组件更灵活。</p> <p>还是以 Button 为例子：一个没有任何样子的 Button 应该是长这个样子：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span><span class="token operator">&gt;</span>Click Me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对应 Click Me！位置应该是我们用 Button 组件包裹的子元素，对应 Vue 里面的 slot。改造一下变成：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>OK 下面就对 Step1 的 props 进行注入，首先我们先划分下功能：</p> <table><thead><tr><th style="text-align:left">属性</th> <th style="text-align:left">功能划分</th> <th style="text-align:center">代码划分</th></tr></thead> <tbody><tr><td style="text-align:left">disabled</td> <td style="text-align:left">不可点击：onClick 失效，CSS 改变</td> <td style="text-align:center">JS、CSS</td></tr> <tr><td style="text-align:left">href</td> <td style="text-align:left">button 标签改变为 a 标签</td> <td style="text-align:center">JS</td></tr> <tr><td style="text-align:left">htmlType</td> <td style="text-align:left">设置 button</td> <td style="text-align:center">JS</td></tr> <tr><td style="text-align:left">loading</td> <td style="text-align:left">增加 Icon loading，onClick 失效</td> <td style="text-align:center">JS</td></tr> <tr><td style="text-align:left">size</td> <td style="text-align:left">只需要修改 CSS 改变 button 宽高即可</td> <td style="text-align:center">CSS</td></tr> <tr><td style="text-align:left">type</td> <td style="text-align:left">根据 type 值修改对应的 css 颜色</td> <td style="text-align:center">CSS</td></tr> <tr><td style="text-align:left">onClick</td> <td style="text-align:left">button 中不需要对 click 做包装</td> <td style="text-align:center">JS</td></tr> <tr><td style="text-align:left">block</td> <td style="text-align:left">修改 display 属性、宽度属性</td> <td style="text-align:center">CSS</td></tr></tbody></table> <h3 id="首先我们先来处理-js-的部分"><a href="#首先我们先来处理-js-的部分" aria-hidden="true" class="header-anchor">#</a> 首先我们先来处理 JS 的部分</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
从props里面拿到所有的参数
*/</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> disabled<span class="token punctuation">,</span> children<span class="token punctuation">,</span> onClick<span class="token punctuation">,</span> href <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
<span class="token comment">// 根据disabled和loading状态，判断onClick是否可点击</span>
<span class="token keyword">const</span> isDisabled <span class="token operator">=</span> disabled <span class="token operator">||</span> loading <span class="token operator">?</span> <span class="token punctuation">{</span> disabled<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> onClick <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//定义所有参数集合（目前只有一个、其他都是css的）</span>
<span class="token keyword">const</span> baseProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>isDisabled
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//判断loading状态，增加loading状态图标</span>
<span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>loading <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Icon type<span class="token operator">=</span><span class="token string">&quot;loading&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//判断是否有href参数，有则为a标签。</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>href<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>disabled <span class="token operator">?</span> <span class="token string">&quot;#&quot;</span> <span class="token punctuation">:</span> href<span class="token punctuation">}</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>disabled<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>content<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//正常返回button</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> <span class="token punctuation">{</span><span class="token operator">...</span>baseProps<span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>content<span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="第三部分-利用-classnames，给组件美化"><a href="#第三部分-利用-classnames，给组件美化" aria-hidden="true" class="header-anchor">#</a> 第三部分: 利用 classnames，给组件美化</h2> <ul><li>工具<a href="https://www.npmjs.com/package/classnames" target="_blank" rel="noopener noreferrer">classnames<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
安装</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yarn add classnames
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>具体用法：</p> <ul><li>普通使用</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">import</span> classNames from <span class="token string">'classNames'</span><span class="token punctuation">;</span>

classNames<span class="token punctuation">(</span><span class="token string">'foo'</span>, <span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'foo bar'</span>
classNames<span class="token punctuation">(</span><span class="token string">'foo'</span>, <span class="token punctuation">{</span> bar: <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'foo bar'</span>
classNames<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'foo-bar'</span><span class="token keyword">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'foo-bar'</span>
classNames<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'foo-bar'</span><span class="token keyword">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">''</span>
classNames<span class="token punctuation">(</span><span class="token punctuation">{</span> foo: <span class="token boolean">true</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> bar: <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'foo bar'</span>
classNames<span class="token punctuation">(</span><span class="token punctuation">{</span> foo: true, bar: <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'foo bar'</span>
classNames<span class="token punctuation">(</span><span class="token punctuation">{</span> foo: true, bar: <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'foo'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>在 react 中使用</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">import</span> classNames from <span class="token string">'classNames'</span><span class="token punctuation">;</span>

render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prefixCls <span class="token operator">=</span> <span class="token string">'button'</span><span class="token punctuation">;</span>
  const className<span class="token operator">=</span> classNames<span class="token punctuation">(</span>prefixCls, <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-primary<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-warning<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-success<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-error<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-default<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-normal<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-info<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-disabled<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-loading<span class="token variable">`</span></span><span class="token punctuation">]</span>: true,
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token punctuation">{</span>className<span class="token punctuation">}</span><span class="token operator">&gt;</span>Hello World<span class="token operator">&lt;</span>/button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>下面就可以根据 Step2 中的和 CSS 有关的样式写出一份 className 集合：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>static defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  prefixCls: <span class="token string">'button'</span>,
<span class="token punctuation">}</span>
static propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  prefixCls: PropTypes.string
<span class="token punctuation">}</span>
const <span class="token punctuation">{</span>
  loading,
  disabled,
  block,
  prefixCls,
  type,
  className,
  size,
  <span class="token punctuation">..</span>.attr
<span class="token punctuation">}</span> <span class="token operator">=</span> this.props

const checkType <span class="token operator">=</span> btnType <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">type</span> <span class="token operator">==</span><span class="token operator">=</span> btnType

const baseProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  className: cls<span class="token punctuation">(</span>prefixCls, <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-primary<span class="token variable">`</span></span><span class="token punctuation">]</span>: checkType<span class="token punctuation">(</span><span class="token string">'primary'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-warning<span class="token variable">`</span></span><span class="token punctuation">]</span>: checkType<span class="token punctuation">(</span><span class="token string">'warning'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-success<span class="token variable">`</span></span><span class="token punctuation">]</span>: checkType<span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-error<span class="token variable">`</span></span><span class="token punctuation">]</span>: checkType<span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-danger<span class="token variable">`</span></span><span class="token punctuation">]</span>: checkType<span class="token punctuation">(</span><span class="token string">'danger'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-default<span class="token variable">`</span></span><span class="token punctuation">]</span>: <span class="token operator">!</span>disabled <span class="token operator">&amp;&amp;</span> checkType<span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-normal<span class="token variable">`</span></span><span class="token punctuation">]</span>: checkType<span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-info<span class="token variable">`</span></span><span class="token punctuation">]</span>: checkType<span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">)</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-disabled<span class="token variable">`</span></span><span class="token punctuation">]</span>: disabled,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-loading<span class="token variable">`</span></span><span class="token punctuation">]</span>: loading,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-block<span class="token variable">`</span></span><span class="token punctuation">]</span>: block,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-large<span class="token variable">`</span></span><span class="token punctuation">]</span>: size <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'large'</span>,
    <span class="token punctuation">[</span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>prefixCls<span class="token punctuation">}</span>-small<span class="token variable">`</span></span><span class="token punctuation">]</span>: size <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'small'</span>,
    className,
  <span class="token punctuation">}</span><span class="token punctuation">)</span>,
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>再将对应的 baseProps 注入到 button 中。这样一来，根据 props，button 会被打上不同的 class 名称。</p> <p>接下来，只需要在 css 文件里面将这些 class 一一实现即可。</p> <ul><li>工具<a href="https://www.npmjs.com/package/less" target="_blank" rel="noopener noreferrer">less<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
安装</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yarn add <span class="token function">less</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们的 css 采用的预处理工具是 less。具体代码这里就不贴出来了。列举几点细节：</p> <ul><li>将有可能在其他组件内使用的样式定义成变量。例如：color，background-color，border-color</li> <li>将相同的 class 内部的方法通过 less 函数传递不同 color 色值</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&amp;</span>.@<span class="token punctuation">{</span>prefixcls<span class="token punctuation">}</span>-warning <span class="token punctuation">{</span>
  .button-hover<span class="token punctuation">(</span>@warning-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&amp;</span>.@<span class="token punctuation">{</span>prefixcls<span class="token punctuation">}</span>-primary <span class="token punctuation">{</span>
  .button-hover<span class="token punctuation">(</span>@primary-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
//less函数接收color
button-hover<span class="token punctuation">(</span>@color: @default-color, @font-color: <span class="token comment">#fff) {</span>
  color: @font-color<span class="token punctuation">;</span>
  background-color: @color<span class="token punctuation">;</span>
  border: 1px solid @color<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="第四部分-添砖加瓦"><a href="#第四部分-添砖加瓦" aria-hidden="true" class="header-anchor">#</a> 第四部分: 添砖加瓦</h2> <p>开篇的时候说了。开发 UI 组件的目的除了学习之外还有定制化和改造。这部分内容是让我们的组件与众不同的地方。</p> <p>举个例子： antd 的组件 同样的 button 组件。</p> <p>从源码中我们可以看到，antd 的 button 组件被一个叫 Wave 的标签包裹：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&lt;</span>Wave<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/Wave<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Wave 组件，就是给被包裹的元素点击的时候增加一个水波纹效果。</p> <p>又或者<a href="https://material-ui.com/demos/buttons/#buttons" target="_blank" rel="noopener noreferrer">material-UI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>效果等等。</p> <p>总而言之，第四部分就是给我们的组件做定制化的地方。小伙伴们可以尽情的发挥自己的想象，让我们的组件与众不同。</p> <h2 id="第五部分-单元测试"><a href="#第五部分-单元测试" aria-hidden="true" class="header-anchor">#</a> 第五部分: 单元测试</h2> <p>一个成熟的组件，单元测试是必不可少的。这里推荐使用 Jest+enzyme</p> <p>这里简单举个例子：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">import</span> React from <span class="token string">'react'</span>
<span class="token function">import</span> <span class="token punctuation">{</span> render, shallow <span class="token punctuation">}</span> from <span class="token string">'enzyme'</span>
<span class="token function">import</span> Button from <span class="token string">'button'</span>

it<span class="token punctuation">(</span><span class="token string">'should can trigger click event'</span>, <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  const onClick <span class="token operator">=</span> jest.fn<span class="token punctuation">(</span><span class="token punctuation">)</span>
  const wrapper <span class="token operator">=</span> shallow<span class="token punctuation">(</span><span class="token operator">&lt;</span>Button onClick<span class="token operator">=</span><span class="token punctuation">{</span>onClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>button<span class="token operator">&lt;</span>/Button<span class="token operator">&gt;</span><span class="token punctuation">)</span>
  wrapper.find<span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span>.simulate<span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
  expect<span class="token punctuation">(</span>onClick<span class="token punctuation">)</span>.toHaveBeenCalled<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <!----> <!----> <div class="page-edit" data-v-4bd020d4><!----> <div class="last-updated" data-v-4bd020d4><span class="prefix" data-v-4bd020d4>Last Updated: </span> <span class="time" data-v-4bd020d4>3/5/2019, 12:10:26 AM</span></div></div> <div class="page-nav" data-v-4bd020d4><p class="inner" data-v-4bd020d4><span class="prev" data-v-4bd020d4>
        ←
        <a href="/react/react生命周期.html" class="prev" data-v-4bd020d4>
          React 生命周期
        </a></span> <!----></p></div> </div> <div class="valine-wrapper" data-v-63f18ac0><div id="valine" style="display:;" data-v-63f18ac0></div></div> <!----> <!----> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-41016a8b data-v-41016a8b><i class="iconfont reco-up" data-v-41016a8b></i></div></div></div>
    <script src="/assets/js/app.21fc7165.js" defer></script><script src="/assets/js/91.5df52d19.js" defer></script>
  </body>
</html>
