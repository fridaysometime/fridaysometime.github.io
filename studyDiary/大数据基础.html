<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>大数据基础 | 我的小天地</title>
    <meta name="description" content="here is mysite">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.f00e75f3.css" as="style"><link rel="preload" href="/assets/js/app.21fc7165.js" as="script"><link rel="preload" href="/assets/js/129.a1d4aea2.js" as="script"><link rel="prefetch" href="/assets/js/10.77ddf168.js"><link rel="prefetch" href="/assets/js/100.72376ebc.js"><link rel="prefetch" href="/assets/js/101.7e92dcce.js"><link rel="prefetch" href="/assets/js/102.d26ace53.js"><link rel="prefetch" href="/assets/js/103.4f071c6b.js"><link rel="prefetch" href="/assets/js/104.68913947.js"><link rel="prefetch" href="/assets/js/105.7c5f4e31.js"><link rel="prefetch" href="/assets/js/106.d3f3424c.js"><link rel="prefetch" href="/assets/js/107.384cbc4b.js"><link rel="prefetch" href="/assets/js/108.58c1a8ed.js"><link rel="prefetch" href="/assets/js/109.592ca513.js"><link rel="prefetch" href="/assets/js/11.fb633ed3.js"><link rel="prefetch" href="/assets/js/110.2387ccdb.js"><link rel="prefetch" href="/assets/js/111.3adc7fd4.js"><link rel="prefetch" href="/assets/js/112.043aeb0d.js"><link rel="prefetch" href="/assets/js/113.28e7ece7.js"><link rel="prefetch" href="/assets/js/114.c2a39640.js"><link rel="prefetch" href="/assets/js/115.d69cc20a.js"><link rel="prefetch" href="/assets/js/116.23269a8b.js"><link rel="prefetch" href="/assets/js/117.bb096cb5.js"><link rel="prefetch" href="/assets/js/118.d630c8af.js"><link rel="prefetch" href="/assets/js/119.6b68bb67.js"><link rel="prefetch" href="/assets/js/12.d634c6b6.js"><link rel="prefetch" href="/assets/js/120.2c3c6894.js"><link rel="prefetch" href="/assets/js/121.cb26b817.js"><link rel="prefetch" href="/assets/js/122.8e57909d.js"><link rel="prefetch" href="/assets/js/123.7c4ed3b7.js"><link rel="prefetch" href="/assets/js/124.4d229fc4.js"><link rel="prefetch" href="/assets/js/125.8308ed0a.js"><link rel="prefetch" href="/assets/js/126.57c6442c.js"><link rel="prefetch" href="/assets/js/127.9338f913.js"><link rel="prefetch" href="/assets/js/128.7a0b895a.js"><link rel="prefetch" href="/assets/js/13.e330f7db.js"><link rel="prefetch" href="/assets/js/130.15664e23.js"><link rel="prefetch" href="/assets/js/131.a725dcd2.js"><link rel="prefetch" href="/assets/js/132.838cb70d.js"><link rel="prefetch" href="/assets/js/133.cbdf7276.js"><link rel="prefetch" href="/assets/js/14.c68bef90.js"><link rel="prefetch" href="/assets/js/15.3157a246.js"><link rel="prefetch" href="/assets/js/16.2962be19.js"><link rel="prefetch" href="/assets/js/17.f4f7b3f6.js"><link rel="prefetch" href="/assets/js/18.263a4859.js"><link rel="prefetch" href="/assets/js/19.99fb5921.js"><link rel="prefetch" href="/assets/js/20.24e69b19.js"><link rel="prefetch" href="/assets/js/21.d27fc0ca.js"><link rel="prefetch" href="/assets/js/22.898767e5.js"><link rel="prefetch" href="/assets/js/23.ebd340a0.js"><link rel="prefetch" href="/assets/js/24.b41d02fb.js"><link rel="prefetch" href="/assets/js/25.f85ce66b.js"><link rel="prefetch" href="/assets/js/26.e3a66d4f.js"><link rel="prefetch" href="/assets/js/27.1db2160c.js"><link rel="prefetch" href="/assets/js/28.9dee9ccb.js"><link rel="prefetch" href="/assets/js/29.a4bc7d56.js"><link rel="prefetch" href="/assets/js/3.87f8e697.js"><link rel="prefetch" href="/assets/js/30.a5d1adac.js"><link rel="prefetch" href="/assets/js/31.ce3a2866.js"><link rel="prefetch" href="/assets/js/32.c022f01a.js"><link rel="prefetch" href="/assets/js/33.7b2bd810.js"><link rel="prefetch" href="/assets/js/34.e368eaf9.js"><link rel="prefetch" href="/assets/js/35.a53794dd.js"><link rel="prefetch" href="/assets/js/36.90e47b7b.js"><link rel="prefetch" href="/assets/js/37.23a9a793.js"><link rel="prefetch" href="/assets/js/38.4280a64c.js"><link rel="prefetch" href="/assets/js/39.b5569187.js"><link rel="prefetch" href="/assets/js/4.fc2e3498.js"><link rel="prefetch" href="/assets/js/40.a222dcd7.js"><link rel="prefetch" href="/assets/js/41.d7d087d2.js"><link rel="prefetch" href="/assets/js/42.0283d3c0.js"><link rel="prefetch" href="/assets/js/43.32388d5e.js"><link rel="prefetch" href="/assets/js/44.e4e23599.js"><link rel="prefetch" href="/assets/js/45.4aba455a.js"><link rel="prefetch" href="/assets/js/46.60750c8e.js"><link rel="prefetch" href="/assets/js/47.d0d66696.js"><link rel="prefetch" href="/assets/js/48.c00c91da.js"><link rel="prefetch" href="/assets/js/49.c7ee7317.js"><link rel="prefetch" href="/assets/js/5.073f04da.js"><link rel="prefetch" href="/assets/js/50.49c34cfe.js"><link rel="prefetch" href="/assets/js/51.4969bb0f.js"><link rel="prefetch" href="/assets/js/52.9af50168.js"><link rel="prefetch" href="/assets/js/53.9eaf0570.js"><link rel="prefetch" href="/assets/js/54.9b525d72.js"><link rel="prefetch" href="/assets/js/55.037a6cf9.js"><link rel="prefetch" href="/assets/js/56.1a82c27d.js"><link rel="prefetch" href="/assets/js/57.a26897c7.js"><link rel="prefetch" href="/assets/js/58.86e43bad.js"><link rel="prefetch" href="/assets/js/59.3d0dcce9.js"><link rel="prefetch" href="/assets/js/6.cb238ab6.js"><link rel="prefetch" href="/assets/js/60.94e22b00.js"><link rel="prefetch" href="/assets/js/61.10aab864.js"><link rel="prefetch" href="/assets/js/62.850e11a7.js"><link rel="prefetch" href="/assets/js/63.c45c2f9d.js"><link rel="prefetch" href="/assets/js/64.47a82193.js"><link rel="prefetch" href="/assets/js/65.4b9b194e.js"><link rel="prefetch" href="/assets/js/66.33263553.js"><link rel="prefetch" href="/assets/js/67.4207ce17.js"><link rel="prefetch" href="/assets/js/68.b559d50a.js"><link rel="prefetch" href="/assets/js/69.4305dd76.js"><link rel="prefetch" href="/assets/js/7.734625c8.js"><link rel="prefetch" href="/assets/js/70.20f2775d.js"><link rel="prefetch" href="/assets/js/71.6fffb114.js"><link rel="prefetch" href="/assets/js/72.236d90cd.js"><link rel="prefetch" href="/assets/js/73.5b801045.js"><link rel="prefetch" href="/assets/js/74.5698c503.js"><link rel="prefetch" href="/assets/js/75.b7c0b5dc.js"><link rel="prefetch" href="/assets/js/76.55208887.js"><link rel="prefetch" href="/assets/js/77.6050e344.js"><link rel="prefetch" href="/assets/js/78.f2df4ed8.js"><link rel="prefetch" href="/assets/js/79.38139ab0.js"><link rel="prefetch" href="/assets/js/8.204c29ff.js"><link rel="prefetch" href="/assets/js/80.faf07d95.js"><link rel="prefetch" href="/assets/js/81.89134c80.js"><link rel="prefetch" href="/assets/js/82.a1b28472.js"><link rel="prefetch" href="/assets/js/83.5c3f0588.js"><link rel="prefetch" href="/assets/js/84.02d8001e.js"><link rel="prefetch" href="/assets/js/85.dbfb4564.js"><link rel="prefetch" href="/assets/js/86.8f8a28e5.js"><link rel="prefetch" href="/assets/js/87.47410eb6.js"><link rel="prefetch" href="/assets/js/88.57b92e6e.js"><link rel="prefetch" href="/assets/js/89.eb0bc727.js"><link rel="prefetch" href="/assets/js/9.4ed47bd6.js"><link rel="prefetch" href="/assets/js/90.853e4852.js"><link rel="prefetch" href="/assets/js/91.5df52d19.js"><link rel="prefetch" href="/assets/js/92.70253793.js"><link rel="prefetch" href="/assets/js/93.2f432fed.js"><link rel="prefetch" href="/assets/js/94.0c32d97b.js"><link rel="prefetch" href="/assets/js/95.dc1bc72e.js"><link rel="prefetch" href="/assets/js/96.8711aa7d.js"><link rel="prefetch" href="/assets/js/97.8aa87e11.js"><link rel="prefetch" href="/assets/js/98.cd50d53c.js"><link rel="prefetch" href="/assets/js/99.b4c61b3a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.241ee574.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f00e75f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header id="navbarWrapper" class="navbar"><div class="sidebar-button"><i class="iconfont reco-menu"></i></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">我的小天地</span></a> <div class="links" style="max-width:nullpx;"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      blogs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/" class="nav-link"><i class="iconfont undefined"></i>
  React学习汇总
</a></li><li class="dropdown-item"><!----> <a href="/vuePress/" class="nav-link"><i class="iconfont undefined"></i>
  使用 GitHub Pages 和 VuePress 搭建网站
</a></li><li class="dropdown-item"><!----> <a href="/studyDiary/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  学习总结
</a></li><li class="dropdown-item"><!----> <a href="/pythonLeetcode/" class="nav-link"><i class="iconfont undefined"></i>
  Python_leetcode
</a></li><li class="dropdown-item"><!----> <a href="/newyear2020/" class="nav-link"><i class="iconfont undefined"></i>
  NewYear_2020
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont undefined"></i>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      GitHub
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fridaysometime" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub地址
  </a></li></ul></div></div><div class="nav-item"><a href="/tags/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      blogs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/" class="nav-link"><i class="iconfont undefined"></i>
  React学习汇总
</a></li><li class="dropdown-item"><!----> <a href="/vuePress/" class="nav-link"><i class="iconfont undefined"></i>
  使用 GitHub Pages 和 VuePress 搭建网站
</a></li><li class="dropdown-item"><!----> <a href="/studyDiary/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  学习总结
</a></li><li class="dropdown-item"><!----> <a href="/pythonLeetcode/" class="nav-link"><i class="iconfont undefined"></i>
  Python_leetcode
</a></li><li class="dropdown-item"><!----> <a href="/newyear2020/" class="nav-link"><i class="iconfont undefined"></i>
  NewYear_2020
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont undefined"></i>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      GitHub
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fridaysometime" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub地址
  </a></li></ul></div></div><div class="nav-item"><a href="/tags/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/studyDiary/boxplot.html" class="sidebar-link">箱图</a></li><li><a href="/studyDiary/data_cleaning.html" class="sidebar-link">data_cleaning</a></li><li><a href="/studyDiary/data_distribution.html" class="sidebar-link">数据分布</a></li><li><a href="/studyDiary/Summaries.html" class="sidebar-link">产品概念</a></li><li><a href="/studyDiary/anaconda 基础.html" class="sidebar-link">anaconda 基础</a></li><li><a href="/studyDiary/github_basic.html" class="sidebar-link">Git基础</a></li><li><a href="/studyDiary/SQL基础.html" class="sidebar-link">SQL基础</a></li><li><a href="/studyDiary/mysql相关.html" class="sidebar-link">mysql相关</a></li><li><a href="/studyDiary/大数据基础.html" class="active sidebar-link">大数据基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/studyDiary/大数据基础.html#hadoop" class="sidebar-link">Hadoop</a></li><li class="sidebar-sub-header"><a href="/studyDiary/大数据基础.html#hive-hbase" class="sidebar-link">hive &amp; HBASE</a></li></ul></li><li><a href="/studyDiary/大数据测试方法.html" class="sidebar-link">大数据测试方法</a></li><li><a href="/studyDiary/Flume与kafka.html" class="sidebar-link">Flume与kafka</a></li><li><a href="/studyDiary/hadoop与storm与spark.html" class="sidebar-link">hadoop,storm与spark</a></li><li><a href="/studyDiary/分布式抢锁设计.html" class="sidebar-link">分布式抢锁设计</a></li><li><a href="/studyDiary/feature engineer.html" class="sidebar-link">特征工程</a></li><li><a href="/studyDiary/Nginx服务器.html" class="sidebar-link">Nginx服务器</a></li><li><a href="/studyDiary/cookie和session.html" class="sidebar-link">cookie 和 session</a></li><li><a href="/studyDiary/ES基础.html" class="sidebar-link">ES基础</a></li><li><a href="/studyDiary/http和https.html" class="sidebar-link">http和https</a></li><li><a href="/studyDiary/Linux基础.html" class="sidebar-link">Linux基础</a></li><li><a href="/studyDiary/MongoDB基础.html" class="sidebar-link">MongoDB基础</a></li><li><a href="/studyDiary/Redis基础.html" class="sidebar-link">Redis基础</a></li><li><a href="/studyDiary/Post和Get.html" class="sidebar-link">Post和Get</a></li><li><a href="/studyDiary/JAVA常用的测试框架.html" class="sidebar-link">JAVA常用的测试框架</a></li><li><a href="/studyDiary/Jenkins持续集成.html" class="sidebar-link">Jenkins持续集成</a></li><li><a href="/studyDiary/python2和3的区别.html" class="sidebar-link">python2和3的区别</a></li><li><a href="/studyDiary/python常用的测试框架.html" class="sidebar-link">python常用的测试框架</a></li><li><a href="/studyDiary/Python的filter方法.html" class="sidebar-link">Python的filter方法</a></li><li><a href="/studyDiary/Python之generator.html" class="sidebar-link">Python之generator</a></li><li><a href="/studyDiary/Python之面试.html" class="sidebar-link">Python之面试</a></li><li><a href="/studyDiary/Python之常用排序算法.html" class="sidebar-link">Python之常用排序算法</a></li><li><a href="/studyDiary/Python之迭代器.html" class="sidebar-link">Python之迭代器</a></li><li><a href="/studyDiary/Python之内存回收机制.html" class="sidebar-link">Python之内存回收机制</a></li><li><a href="/studyDiary/Python之爬虫.html" class="sidebar-link">Python之爬虫</a></li><li><a href="/studyDiary/Python之提高运行效率.html" class="sidebar-link">Python之提高运行效率</a></li><li><a href="/studyDiary/python3之super.html" class="sidebar-link">python3之super</a></li><li><a href="/studyDiary/python多线程.html" class="sidebar-link">python多线程</a></li><li><a href="/studyDiary/python之装饰器.html" class="sidebar-link">python之装饰器</a></li></ul></div></li></ul> </div> <div class="page" data-v-4bd020d4> <div class="page-title" data-v-4bd020d4><h1 data-v-4bd020d4>大数据基础</h1> <hr data-v-4bd020d4> <div data-v-2c25cede data-v-4bd020d4><i class="iconfont reco-account" data-v-2c25cede><span data-v-2c25cede>我的小天地</span></i> <i class="iconfont reco-date" data-v-2c25cede><span data-v-2c25cede>2019-3-12</span></i> <!----> <i class="iconfont reco-tag tags" data-v-2c25cede><span class="tag-item" data-v-2c25cede>
      大数据
    </span></i></div></div> <div class="content" data-v-4bd020d4><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>做项目的时候了解一下大数据的相关知识，只恨我们技术浅薄，能学以致用的点太少，大数据的知识又多又深，我们所了解的也只是皮毛，应用在项目中的也都是基础的东西；如果保证数据的质量，如何提高数据类产品质量的测试效率，如何测试算法，我们探究了一年多，然而效果却很单薄</p></div> <h1 id="大数据基础"><a href="#大数据基础" aria-hidden="true" class="header-anchor">#</a> 大数据基础</h1> <h2 id="hadoop"><a href="#hadoop" aria-hidden="true" class="header-anchor">#</a> Hadoop</h2> <p>hadoop内部拆分成几个独立的模块，存储与计算功能独立：</p> <p>HDFS为分布式文件系统，负责文件存储</p> <p>MapReduce，MR，计算框架提供计算支持</p> <p>YARN是资源调度模块，MR程序由yarn来调度运行，同时yarn还可以为其他系统提供调度服务，如spark</p> <h3 id="hdfs基本命令"><a href="#hdfs基本命令" aria-hidden="true" class="header-anchor">#</a> HDFS基本命令</h3> <ol><li><p>根目录：hdfs dfs -ls,</p> <p>hdfs dfs -ls  /</p> <p>显示所有：hdfs dfs -ls -R,太多了一般不要直接用，用grep过滤</p></li> <li><p>删除在根目录的空文件夹：hdfs dfs -rm -r \xulintest</p> <p>根目录的路径：hdfs://ns15/user/mart_cis/xulin</p></li> <li><p>查看对应目录下的文件：比如查看某个表的文件</p> <p>hdfs dfs -ls hdfs://ns15/user/mart_cis/dev.db/dev_op_pop_sku_elasticity_da</p></li> <li><p>文件从HDFS上下载到本地的命令。</p> <p>get</p> <p>使用方法：hadoop fs -get [-ignorecrc][-crc] <src><localdst></localdst></src></p> <p>hadoop fs -get /user/hadoop/file localfile</p> <p>hadoop fs -get hdfs://host:port/user/hadoop/file localfile</p></li> <li><p>多级目录-需要一级一级的创建
首先到hdfs的用户-然后创建
su hdfs</p> <pre><code>hdfs dfs -mkdir /Test
hdfs dfs -mkdir /Test/first
hdfs dfs -mkdir /Test/first/data
hdfs dfs -mkdir /Test/first/data/ok
</code></pre></li> <li><p>删除目录首先查看当前用户，再查看准备删除的目录的文件之后--删除，以确保没有误操作
rf参数表示递归强制删除-尽量不用强制删除
rm命令删除指定的文件，只删除 非空目录 和 文件
删除空目录 - r 指示rm将参数中列出的全部目录和子目录均递归地删除
hdfs  dfsadmin -report
hdfs dfs -ls  /test/
hdfs dfs -ls  /test/happy
hdfs dfs -rm  -r -f /test/happy</p></li> <li><p>报告HDFS的基本统计信息</p> <p>hdfs dfsadmin -report</p></li> <li><p>统计多个文件行数</p> <p>hdfs dfs -cat  /test/first_data_ok_20129* | wc -l</p></li> <li><p>统计文件大小</p> <p>hdfs dfs -count /test/first_data_ok_20129</p></li> <li><p>查看文件的前几行--具体到文件
hdfs dfs -tail /test/first_data_ok_2012.json</p></li> <li><p>查看部分文件
hdfs dfs -ls  /Test/tmp/first_data_ok_20151203*</p></li></ol> <h2 id="hive-hbase"><a href="#hive-hbase" aria-hidden="true" class="header-anchor">#</a> hive &amp; HBASE</h2> <p>Hbase和Hive在大数据架构中处在不同位置，Hbase主要解决实时数据查询问题，Hive主要解决数据处理和计算问题，一般是配合使用。</p> <p>区别：</p> <ol><li>Hbase：Hadoop database的简称，也就是基于Hadoop数据库，是一种NoSQL数据库，主要适用于海量明细数据（十亿、百亿）的随机实时查询，如日志明细、交易清单、轨迹行为等；</li> <li>Hive：Hive是Hadoop数据仓库，严格来说，不是数据库，主要是让开发人员能够通过SQL来计算和处理HDFS上的结构化数据，适用于离线的批量数据计算。
<ul><li>通过元数据来描述Hdfs上的结构化文本数据，通俗点来说，就是定义一张表来描述HDFS上的结构化文本，包括各列数据名称，数据类型是什么等，方便我们处理数据，当前很多SQL      ON Hadoop的计算引擎均用的是hive的元数据，如Spark SQL、Impala等；</li> <li>基于第一点，通过SQL来处理和计算HDFS的数据，Hive会将SQL翻译为Mapreduce来处理数据；</li></ul></li></ol> <p>联系：在大数据架构中，Hive和HBase是协作关系，数据流一般如下</p> <ol><li>通过ETL工具将数据源抽取到HDFS存储；</li> <li>通过Hive清洗、处理和计算原始数据；</li> <li>HIve清洗处理后的结果，如果是面向海量数据随机查询场景的可存入Hbase；</li> <li>数据应用从HBase查询数据；</li></ol> <h1 id="spark"><a href="#spark" aria-hidden="true" class="header-anchor">#</a> spark</h1> <p>Spark: spark的核心是一种新型的大数据计算框架，可以基于Hadoop上存储的大数据进行计算（HDFS,hive ）Spark替代Hadoop的一部分，只是替代其计算框架，mapreduce,hive，但spark本身不提供大数据存储;</p> <p><strong>spark 和 mr</strong>:</p> <p>spark的计算模型与MapReduce是完全不同的，spark是基于内存的一种计算框架,有时也会使用磁盘，spark shuffle也会使用磁盘，但是很多操作，比如说简单的map，没有reduce操作，或者是filter类的操作，都是可以直接基于内存进行计算的。</p> <p>MapReduce的计算模型非常固定，而且死板，必须基于磁盘，以及大量的网络传输;</p> <p>所以，spark的速度可以比MapReduce，hive底层也是基于MapReduce来执行SQL语句的，速度快速至少数倍，甚至十倍上百倍。</p> <p><strong>spark运行模式</strong>：</p> <p>spark有很多种模式，最简单就是单机本地模式，还有单机伪分布式模式，复杂的则运行在集群中，目前能很好的运行在 Yarn和 Mesos
中，当然 Spark 还有自带的 Standalone 模式，对于大多数情况 Standalone 模式就足够了，如果企业已经有 Yarn 或者 Mesos
环境，也是很方便部署的。</p> <ul><li><p>local(本地模式)：常用于本地开发测试，本地还分为local单线程和local-cluster多线程;</p> <ul><li><p>本地：该模式被称为Local[N]模式，是用单机的多个线程来模拟Spark分布式计算，通常用来验证开发出来的应用程序逻辑上有没有问题。其中N代表可以使用N个线程，每个线程拥有一个core。如果不指定N，则默认是1个线程（该线程有1个core）。</p> <p>如果是local[*]，则代表 Run Spark locally with as many worker threads as logical cores on your machine.</p> <p>如下：</p> <p>spark-submit 和 spark-submit --master local 效果是一样的</p> <p>（同理：spark-shell 和 spark-shell --master local 效果是一样的）</p> <p>spark-submit --master local[4] 代表会有4个线程（每个线程一个core）来并发执行应用程序。</p></li> <li><p>本地伪集群：这种运行模式，和Local[N]很像，不同的是，它会在单机启动多个进程来模拟集群下的分布式场景，而不像Local[N]这种多个线程只能在一个进程下委屈求全的共享资源。通常也是用来验证开发出来的应用程序逻辑上有没有问题，或者想使用Spark的计算框架而没有太多资源。</p> <p>用法是：提交应用程序时使用local-cluster[x,y,z]参数：x代表要生成的executor数，y和z分别代表每个executor所拥有的core和memory数。</p> <p><code>spark-submit --master local-cluster[2, 3, 1024]</code></p> <p>（同理：spark-shell --master local-cluster[2, 3, 1024]用法也是一样的）</p> <p>上面这条命令代表会使用2个executor进程，每个进程分配3个core和1G的内存，来运行应用程序。</p> <p>SparkSubmit依然充当全能角色，又是Client进程，又是driver程序，还有点资源管理的作用。生成的两个CoarseGrainedExecutorBackend，就是用来并发执行程序的进程。</p> <p>运行该模式依然非常简单，只需要把Spark的安装包解压后，改一些常用的配置即可使用。而不用启动Spark的Master、Worker守护进程( 只有集群的standalone方式时，才需要这两个角色)，也不用启动Hadoop的各服务（除非你要用到HDFS），这是和其他模式的区别哦，要记住才能理解。</p></li></ul></li> <li><p>standalone(集群模式)：典型的Mater/slave模式，不过也能看出Master是有单点故障的；Spark支持ZooKeeper来实现HA; Spark standalone模式下，集群资源调度由master节点复制。standalone模式只支持简单的资源分配策略，每个人物固定数量的core，各job按顺序依次分配资源，资源不够时排队等待。</p> <ul><li><p>standalone-client:</p> <p>和单机运行的模式不同，这里必须在执行应用程序前，先启动Spark的Master和Worker守护进程。不用启动Hadoop服务，除非你用到了HDFS的内容。</p> <p><code>start-master.sh</code></p> <p><code>start-slave.sh -h hostname url:master</code></p> <p>图省事，可以在想要做为Master的节点上用start-all.sh一条命令即可，不过这样做，和上面的分开配置有点差别，以后讲到数据本地性如何验证时会说。</p> <p>这种运行模式，可以使用Spark的8080 web ui来观察资源和应用程序的执行情况了。</p> <p>言归正传，用如下命令提交应用程序</p> <p>spark-submit --master spark://wl1:7077</p> <p>或者 spark-submit --master spark://wl1:7077 --deploy-mode client</p> <p>代表着会在所有有Worker进程的节点上启动Executor来执行应用程序，此时产生的JVM进程如下：（非master节点，除了没有Master、SparkSubmit，其他进程都一样）</p> <p>Master进程做为cluster manager，用来对应用程序申请的资源进行管理；</p> <p>SparkSubmit 做为Client端和运行driver程序；</p> <p>CoarseGrainedExecutorBackend 用来并发执行应用程序；</p> <p>注意，Worker进程生成几个Executor，每个Executor使用几个core，这些都可以在spark-env.sh里面配置，此处不在啰嗦。</p></li> <li><p>standalone-cluster:</p> <p>使用如下命令执行应用程序（前提是已经启动了spark的Master、Worker守护进程）不用启动Hadoop服务，除非你用到了HDFS的内容。</p></li></ul></li></ul> <p>​		spark-submit --master spark://wl1:6066 --deploy-mode cluster</p> <p>​		客户端的SparkSubmit进程会在应用程序提交给集群之后就退出;</p> <p>​		Master会在集群中选择一个Worker进程生成一个子进程DriverWrapper来启动driver程序;</p> <p>​		而该DriverWrapper 进程会占用Worker进程的一个core，所以同样的资源下配置下​会比第3种运行模式，少用1个core来参与计算(观察下图executor id 7的core数);应用程序的结果，会在执行driver程序的节点的stdout中输出，而不是打印在屏幕上;</p> <ul><li><p>on yarn(集群模式)：运行在 yarn 资源管理器框架之上，由 yarn 负责资源管理，Spark 负责任务调度和计算;</p> <ul><li><p>on client:</p> <p>现在越来越多的场景，都是Spark跑在Hadoop集群中，所以为了做到资源能够均衡调度，会使用YARN来做为Spark的Cluster Manager，来为Spark的应用程序分配资源。</p> <p>在执行Spark应用程序前，要启动Hadoop的各种服务。由于已经有了资源管理器，所以不需要启动Spark的Master、Worker守护进程。相关配置的修改，请自行研究。</p> <p>使用如下命令执行应用程序</p> <p>spark-submit --master yarn</p> <p>或者 spark-submit --master yarn --deploy-mode client</p> <p>提交应用程序后，各节点会启动相关的JVM进程，如下：</p> <p>在Resource Manager节点上提交应用程序，会生成SparkSubmit进程，该进程会执行driver程序。</p></li> <li><p>on cluster:</p> <p>使用如下命令执行应用程序:</p> <p>spark-submit --master yarn --deploy-mode cluster</p> <p>和第5种运行模式，区别如下：</p> <p>在Resource Manager端提交应用程序，会生成SparkSubmit进程，该进程只用来做Client端，应用程序提交给集群后，就会删除该进程。</p> <p>Resource Manager在集群中的某个NodeManager上运行ApplicationMaster，该AM同时会执行driver程序。紧接着，会在各NodeManager上运行CoarseGrainedExecutorBackend来并发执行应用程序。</p></li></ul></li> <li><p>on mesos(集群模式)：运行在 mesos 资源管理器框架之上，由 mesos 负责资源管理，Spark 负责任务调度和计算;</p></li> <li><p>on      cloud(集群模式)：比如 AWS 的 EC2，使用这个模式能很方便的访问 Amazon的 S3;Spark 支持多种分布式存储系统：HDFS 和 S3;</p></li></ul> <ol><li></li></ol> <p>df = sqlContext.createDataFrame([(&quot;a&quot;, 14, 13.0),(&quot;c&quot;, 14, 33.0),(&quot;d&quot;, 21, 23.0),(&quot;e&quot;, 21, 3.0)], (&quot;cust&quot;, &quot;x2&quot;, &quot;x3&quot;))
请写出一条语句spark或hive语句，使用窗口函数按x2分组，找出每组中最小的记录
a=df.withColumn(&quot;rn&quot;, F.row_number().over(Window.partitionBy(&quot;x2&quot;).orderBy(F.asc(&quot;x3&quot;)))).filter(&quot;rn = 1&quot;).drop(&quot;rn&quot;)</p> <ol start="2"><li></li></ol> <p>利用nohup写出一条命令将spark submit提交的test.py的日志写入指定的路径（/home/test/result.log）
nohup spark-submit test.py 1&gt;/home/test/result.log &amp;</p> <p>nohup sh promo_elasity_submit.sh promo_elasticity_calculate_spark.py 2017-12-31 2017-01-01 insert 1&gt;/home/test/result.log &amp;</p> <ol start="3"><li></li></ol> <p>简述hive的row_number()、percent_rank()，rank()和dense_rank()的区别以及具体使用场景；并为下面的场景写一段符合要求的hivesql
学生表student：包括字段age（年龄）,gender（性别）,no(学号)，总共10条记录，分别查找男女中年龄由大到小排名前3的人（排名不连续，人数可能大于3）</p> <p>row_number:不管排名是否有相同的，都按照顺序1，2，3…..n
rank:排名相同的名次一样，同一排名有几个，后面排名就会跳过几次
dense_rank:排名相同的名次一样，且后面名次不跳跃
percent_rank() 返回相对百分比排名</p> <p>select gender,age, rank() over (partition by gender order by age desc) as ranks from student having ranks&lt;=3</p> <ol start="4"><li></li></ol> <p>df = sqlContext.createDataFrame([(&quot;a&quot;, 14, 1),(&quot;c&quot;, 64, 2),(&quot;d&quot;, 102, 3),(&quot;e&quot;, 20, 4)], (&quot;cust&quot;, &quot;percentage&quot;, &quot;type&quot;))
df为dataframe中包含percentage和type这2个字段，且percentage字段范围应该在[0,100]之间，type在[1,2,3]中取，
写出判断字段的数据范围是否符合要求的语句：
df.filter(~df.type.isin(1,2,3)).show()
df.agg({'percentage':'max'}).collect()[0][0]
df.agg({'percentage':'min'}).collect()[0][0]
答案不唯一，窗口函数也可。</p> <ol start="5"><li></li></ol> <p>简述spark的运行模式</p> <p>Spark 有很多种模式，最简单就是单机本地模式，还有单机伪分布式模式，复杂的则运行在集群中，目前能很好的运行在 Yarn和 Mesos 中，当然 Spark 还有自带的 Standalone 模式，对于大多数情况 Standalone 模式就足够了，如果企业已经有 Yarn 或者 Mesos 环境，也是很方便部署的。
local(本地模式)：常用于本地开发测试，本地还分为local单线程和local-cluster多线程; standalone(集群模式)：典型的Mater/slave模式，不过也能看出Master是有单点故障的；Spark支持ZooKeeper来实现 HA
on yarn(集群模式)： 运行在 yarn 资源管理器框架之上，由 yarn 负责资源管理，Spark 负责任务调度和计算
on mesos(集群模式)： 运行在 mesos 资源管理器框架之上，由 mesos 负责资源管理，Spark 负责任务调度和计算
on cloud(集群模式)：比如 AWS 的 EC2，使用这个模式能很方便的访问 Amazon的 S3;Spark 支持多种分布式存储系统：HDFS 和 S3</p> <ol start="6"><li></li></ol> <p>写出常见的hdfs命令：</p> <p>在根目录创建文件夹hadoop fs -mkdir xulin
删除在根目录的空文件夹：hdfs dfs -rm -r \xulintest
查看对应目录下的文件：比如查看某个数据库下某个表的文件或查看目录结构
hdfs dfs -ls hdfs://ns15/user/mart_cis/dev.db/dev_op_pop_sku_elasticity_da
hdfs dfs -ls  hdfs://ns11/user/mart_rmb/sunzeye/raw_data/elasticity
查看dev_op_pop_sku_elasticity_da表里有多少个分区文件
从hdfs下上下载文件到本地
hadoop fs -get /user/hadoop/file localfile
查看hdfs上某文件
hadoop dfs -cat hdfs://ns11/user/rmb_test_account/test_xl/preprocessed_data/elasticity/part-00000</p> <ol start="7"><li></li></ol> <p>spark中cache(),persist(),checkpoint()分别是什么作用，有什么区别？</p> <p>cache()：会被重复使用的(但是)不能太大的RDD需要cache。cache 只使用 memory，不适用磁盘cache 机制是每计算出一个要 cache 的 partition 就直接将其 cache 到内存了。
checkpoint() ：写磁盘的话那就叫 checkpoint了。没有使用这种第一次计算得到就存储的方法，而是等到 job 结束后另外启动专门的 job 去完成。checkpoint 将 RDD 持久化到 HDFS 或本地文件夹，如果不被手动 remove 掉，是一直存在的。
persist():将 RDD 的 partition 持久化到磁盘，但该 partition 由 blockManager 管理。一旦 driver program 执行结束，也就是 executor 所在进程 CoarseGrainedExecutorBackend stop，blockManager 也会 stop，被 cache 到磁盘上的 RDD 也会被清空。</p></div> <!----> <!----> <div class="page-edit" data-v-4bd020d4><!----> <div class="last-updated" data-v-4bd020d4><span class="prefix" data-v-4bd020d4>Last Updated: </span> <span class="time" data-v-4bd020d4>8/25/2019, 6:38:06 PM</span></div></div> <!----> </div> <div class="valine-wrapper" data-v-63f18ac0><div id="valine" style="display:;" data-v-63f18ac0></div></div> <!----> <!----> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-41016a8b data-v-41016a8b><i class="iconfont reco-up" data-v-41016a8b></i></div></div></div>
    <script src="/assets/js/app.21fc7165.js" defer></script><script src="/assets/js/129.a1d4aea2.js" defer></script>
  </body>
</html>
